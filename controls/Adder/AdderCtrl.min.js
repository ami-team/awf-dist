(()=>{"use strict";$AMIClass("AdderCtrl",{$extends:ami.Control,$init:function(t,i){this.$super.$init(t,i)},onReady:function(){return amiWebApp.loadResources(["ctrl:table"]).done(t=>{this._tableCtor=t[0]})},render:function(t,i,e,n,s){const l=$.Deferred(),d=amiAuth.hasRole("AMI_ADMIN")||amiAuth.hasRole("AMI_WRITER");return this.setupCtx({catalog:i,entity:e,field:n},{context:l,showAddModalFunc:(t,i)=>{this._table.fieldEditor.showRowModal(t,i)},canAdd:d,filter:""},s),this.replaceHTML(this.setSelector(t),'\x3c!---------------------------------------------------------------------------------------------------------------------\x3e\n\n<div class="row w-lg-75 mx-0">\n\n\t\x3c!-----------------------------------------------------------------------------------------------------------------\x3e\n\n\t<div class="col-xl-7 px-0">\n\t\t<div class="card mb-3 m{% if BOOTSTRAP_VERSION > 4 %}e{% else %}r{% endif %}-0 m{% if BOOTSTRAP_VERSION > 4 %}e{% else %}r{% endif %}-lg-3">\n\t\t\t<div class="card-body">\n\t\t\t\t<div class="row">\n\t\t\t\t\t<div class="col-2">\n\t\t\t\t\t\t<i class="bi bi-funnel text-success" style="font-size: 3rem;"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="col-10 p-4">\n\t\t\t\t\t\tSelect <kbd class="rounded-pill">{{ entity|default(\'N/A\')|e }}</kbd> by <kbd class="rounded-pill">{{ entity|default(\'N/A\')|e }}.{{ field|default(\'N/A\')|e }}</kbd>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="card-footer p-2">\n\t\t\t\t<div class="input-group">\n\t\t\t\t\t<input class="form-control" type="text" id="B28F6454_3862_3031_6BAF_98392DE9C377" placeholder="Select {{ entity|default(\'N/A\')|e }} by {{ entity|default(\'N/A\')|e }}.{{ field|default(\'N/A\')|e }}..." />\n\t\t\t\t\t{% if BOOTSTRAP_VERSION > 4 %}\n\t\t\t\t\t<button class="btn btn-outline-primary" type="button" id="EBB91625_148B_1606_0D40_30BF170B11EE">\n\t\t\t\t\t\t<i class="bi bi-arrow-right-circle-fill"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t{% else %}\n\t\t\t\t\t<div class="input-group-append">\n\t\t\t\t\t\t<button class="btn btn-outline-primary" type="button" id="EBB91625_148B_1606_0D40_30BF170B11EE">\n\t\t\t\t\t\t\t<i class="bi bi-arrow-right-circle-fill"></i>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t{% endif %}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t\x3c!-----------------------------------------------------------------------------------------------------------------\x3e\n\n\t<div class="col-xl-5 px-0">\n\t\t<div class="card mb-3 m{% if BOOTSTRAP_VERSION > 4 %}e{% else %}r{% endif %}-0 m{% if BOOTSTRAP_VERSION > 4 %}e{% else %}r{% endif %}-lg-3">\n\t\t\t<div class="card-body">\n\t\t\t\t<div class="row">\n\t\t\t\t\t<div class="col-2">\n\t\t\t\t\t\t<i class="bi bi-plus-lg text-primary" style="font-size: 3rem;"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="col-10 p-4">\n\t\t\t\t\t\tAdd new <kbd class="rounded-pill">{{ entity|default(\'N/A\')|e }}</kbd>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="card-footer p-2">\n\t\t\t\t<div class="input-group">\n\t\t\t\t\t<div class="form-control bg-light2 border-0"></div>\n\t\t\t\t\t{% if BOOTSTRAP_VERSION > 4 %}\n\t\t\t\t\t<button class="btn btn-outline-{% if canAdd %}primary{% else %}secondary{% endif %}" type="button" id="F8A7229A_60B1_0D37_BA18_807B7E29C818">\n\t\t\t\t\t\t<i class="bi bi-arrow-right-circle-fill"></i>\n\t\t\t\t\t</button>\n\t\t\t\t\t{% else %}\n\t\t\t\t\t<div class="input-group-append">\n\t\t\t\t\t\t<button class="btn btn-outline-{% if canAdd %}primary{% else %}secondary{% endif %}" type="button" id="F8A7229A_60B1_0D37_BA18_807B7E29C818">\n\t\t\t\t\t\t\t<i class="bi bi-arrow-right-circle-fill"></i>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t{% endif %}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t\x3c!-----------------------------------------------------------------------------------------------------------------\x3e\n\n</div>\n\n\x3c!---------------------------------------------------------------------------------------------------------------------\x3e\n\n<div id="D6FDA711_E893_7CB9_9B97_4161B2CDE139"></div>\n\n\x3c!---------------------------------------------------------------------------------------------------------------------\x3e\n',{dict:this.ctx}).done(()=>{$(this.patchId("#B28F6454_3862_3031_6BAF_98392DE9C377")).keypress(t=>{13===t.keyCode&&(t.preventDefault(),this.search($(this.patchId("#B28F6454_3862_3031_6BAF_98392DE9C377")).val().trim()))}),$(this.patchId("#EBB91625_148B_1606_0D40_30BF170B11EE")).click(t=>{t.preventDefault(),this.search($(this.patchId("#B28F6454_3862_3031_6BAF_98392DE9C377")).val().trim())}),this.ctx.canAdd&&$(this.patchId("#F8A7229A_60B1_0D37_BA18_807B7E29C818")).click(t=>{t.preventDefault(),this.ctx.showAddModalFunc(this.ctx.catalog,this.ctx.entity)}),$(this.patchId("#B28F6454_3862_3031_6BAF_98392DE9C377")).val(this.ctx.filter),this.search(this.ctx.filter).done((t,i,e,n,s,d)=>{l.resolveWith(this.ctx.context,[t,i,e,n,s,d])}).fail(t=>{l.rejectWith(this.ctx.context,[t])})}),l},search:function(t){let i="SELECT *";return t&&(t.includes("%")?i+=` WHERE \`${this.ctx.field}\` LIKE '${amiWebApp.textToSQL(t)}'`:i+=` WHERE \`${this.ctx.field}\` = '${amiWebApp.textToSQL(t)}'`),amiWebApp.lock(),(this._table=new this._tableCtor).render(this.patchId("#D6FDA711_E893_7CB9_9B97_4161B2CDE139"),`BrowseQuery -catalog="${amiWebApp.textToString(this.ctx.catalog)}" -entity="${amiWebApp.textToString(this.ctx.entity)}" -mql="${amiWebApp.textToString(i)}"`,this.ctx).done(()=>{amiWebApp.unlock()}).fail(t=>{amiWebApp.error(t,!0)})}})})();